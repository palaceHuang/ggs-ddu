
## 防抖

```js
export const debounce = (() => {
    let timer = null;
    return (callback, wait = 800) => {
        timer && clearTimeout(timer);
        timer = setTimeout(callback, wait);
    }
})
```

示例

```js
methods: {
    loadList() {
        debounce(()=>{
            console.log('load data');
        }, 500)
    }
}
```

## 节流

```js
export const throttle = (() => {
    let last = 0;
    return (callback, wait = 800) => {
        let now = +new Date();
        if(now - last > wait) {
            callback();
            last = now;
        } 
    }
})()
```

## 手机号脱敏

```js
export const hideMobile = (mobile) => {
    return mobile.replate(/^(\d{3})\d{4}(\d{4})$/, "$1****$2");
}
```

## 开启全屏

```js
export const launchFullscreen = (element) => {
    if(element.requestFullScreen) {
        element.requestFullscreen();
    } else if(element.mozRequestFullScreen) {
        element.mozRequestFullScreen();
    } else if(element.msRequestFullscreen) {
        element.msRequestFullscreen();
    } else if (element.webkitRequestFullscreen) {
        element.webkitRequestFullscreen();
    }
}
```

## 关闭全屏

```js
export const exitFullscreen = () => {
    if(document.exitFullscreen) {
        document.exitFullscreen();
    } else if(document.msExitFullscreen) {
        document.msExitFullscreen();
    } else if(document.mozCancelFullScreen) {
        document.mozCancelFullScreen();
    } else if (document.webkitExitFullscreen) {
        document.webkitExitFullscreen();
    }
}
```

## 大小写转换

```js
export const turnCase = (str, type) => {
    switch(type) {
        case 1:
            return str.toUpperCase();
        case 2:
            return str.toLowerCase();
        case 3:
            return str[0].toUpperCase() + str.substring(1).toLowerCase();
        default:
            return str;
    }
}
```

## 解析URL参数

```js
export const getSearchParams = () => {
    const searchPar = new URLSearchParams(window.location.search);
    const paramObj = {};
    for(const [key, value] of searchPar.entries()) {
        paramObj[key] = value;
    }

    return paramObj;
}
```

## 数组对象根据字段去重

```js
export const uniqueArrayObject = (arr = [], key = 'id') =》 {
    if (arr.length === 0) return;
    let list = [];
    const map = {};
    arr.forEach((item) => {
        if(!map[item[key]]) {
            map[item[key]] = item;
        }
    })
    list = Object.values(map);

    return list;
}
```

## 滚动到页面顶部

```js
export const scrollToTop = () => {
    const height = document.documentElement.scrollTop || document.body.scrollTop;
    if(height > 0) {
        window.requestAnimationFrame(scrollToTop);
        window.scrollTo(0, height - height / 8);
    }
}
```

## 滚动到元素位置

```js
export const smoothScroll = element => {
    document.querySelector(element).scrollIntoVieww({
        behavior: 'smooth'
    });
};
```

示例：

```js
smoothScroll('#target');
```

## uuid

```js
export  const uuid = () => {
    const temp_url = URL.createObjectURL(new Blob());
    const uuid = temp_url.toString();
    URL.revokeObjectURL(temp_url);
    return uuid.substring(uuid.lastIndexOf('/') + 1);
}
```

示例：

```js
uuid(); // 不过要吐槽一句的是，uuid一般应由后端来进行生成
```

## 下载文件

参数：
- api 接口
- params 请求参数
- fileName 文件名

```js
const downloadFile = (api, params, fileName, type = 'get') => {
    axios({
        method: type,
        url: api,
        responseType:'blob',
        params: params
    }).then((res) => {
        let str = res.headers['content-disposition'];
        if (!res || !str) {
            return;
        }

        let suffix = '';
        // 截取文件名和文件类型
        if(str.lastIndexOf('.')) {
            fileName ? '' : fileName = decodeURI(str.substring(str.indexOf('=') + 1, str.lastIndexOf('.')));
            suffix = str.substring(str.lastIndexOf('.'), str.length);
        }

        // 如果支持微软的文件下载方法（ie10+浏览器）
        if (window.navigator.msSaveBlob) {
            try{
                const blobObject = new Blob([res.data]);
                window.navigator.msSaveBlob(blobObject, fileName + suffix);
            } catch(e) {
                console.log(e);
            }
        } else {
            // 其它浏览器
            let URL= window.URL.createObjectURL(res.data);
            let link = document.createElement('a')；
            link.style.display = 'none';
            link.href = url;
            link.setAttribute('download', fileName + suffix);

            document.body.appendChild(link);
            link.click();
            document.body.removeChild(link);
            window.URL.revokeObjectURL(link.href);
        }
    }).catch((err) => {
        console.log(err.message);
    })
}
```

使用：

```js
downloadFile('/api/download', {id}, '文件名');
```

## 时间操作

关于时间操作，强烈推荐使用day.js 

## 深拷贝

```js
export const clone = parent => {
    // 判断类型
    const isType = (obj, type) => {
        if(typeof obj !== 'object') return false;
        const typeString = Object.prototype.toString.call(obj);

        let flag;
        switch(type) {
            case 'Array':
                flag = typeString === '[object Array]';
                break;
            case 'Date':
                flag = typeString === '[object Date]';
                break;
            case 'RegExp':
                flag = typeString === '[object RegExp]';
                break;
            default:
                flag = false;
        }
        return flag;
    };

    // 处理正则
    const getRegExp = re => {
        var flags = '';
        if(re.global) flags += 'g';
        if(re.ignoreCase) flags += 'i';
        if(re.multiline) flags += 'm';

        return flags;
    }

    // 维护两个储存循环引用的数组
    const parents = [];
    const children = [];

    const _clone = parent => {
        if(parent === null) return null;
        if(typeof parent !== 'object') return parent;

        let child, proto;
        
        if(isType(parent, 'Array')) {
            child = [];
        } else if(isType(parent, 'RegExp')) {
            child = new RegExp(parent.source, getRegExp(parent));
            if(parent.lastIndex) child.lastIndex = parent.lastIndex;
        } else if(isType(parent, 'Date')) {
            child = new Date(parent.getTime());
        } else {
            proto = Object.getPrototypeOf(parent);
            child = Object.create(proto);
        }

        // 处理循环引用
        const index = parents.indexOf(parent);

        if(index != -1) {
            return children[index];
        }
        parents.push(parent);
        children.push(child);

        for(let i in parent) {
            child[i] = _clone(parent[i]);
        }

        return child;
    };
    return _clone(parent);
};
```

```
此方法存在一定局限性：一些特殊情况没有处理（例如Buffer对象、Promise、Set、Map）

如果确实想要完备的深拷贝，推荐使用lodash中的cloneDeep方法
```

## 遍历树节点

```js
export const foreachTree = (data, callback, childrenName = 'children') => {
    for(let i = 0; i < data.length; i++) {
        callback(data[i]);
        if(data[i][childrenName] && data[i][childrenName].length > 0) {
            foreachTree(data[i][childrenName], callback, childrenName);
        }
    }
}
```